root@netology:/opt/ansible_hw4/playbook# ansible-playbook -i inventory/prod.yml site.yml 
[WARNING]: Found both group and host with same name: vector
[WARNING]: Found both group and host with same name: clickhouse
[WARNING]: Found both group and host with same name: lighthouse

PLAY [Install Clickhouse] ***************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] ******************************************************************************************************************************************************************************************************************
[WARNING]: Platform linux on host clickhouse is using the discovered Python interpreter at /usr/bin/python3.12, but future installation of another Python interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-core/2.17/reference_appendices/interpreter_discovery.html for more information.
ok: [clickhouse]

TASK [clickhouse-role : Include OS Family Specific Variables] ***************************************************************************************************************************************************************************
ok: [clickhouse]

TASK [clickhouse-role : include_tasks] **************************************************************************************************************************************************************************************************
included: /opt/ansible_hw4/playbook/roles/clickhouse-role/tasks/precheck.yml for clickhouse

TASK [clickhouse-role : Requirements check | Checking sse4_2 support] *******************************************************************************************************************************************************************
ok: [clickhouse]

TASK [clickhouse-role : Requirements check | Not supported distribution && release] *****************************************************************************************************************************************************
skipping: [clickhouse]

TASK [clickhouse-role : include_tasks] **************************************************************************************************************************************************************************************************
included: /opt/ansible_hw4/playbook/roles/clickhouse-role/tasks/params.yml for clickhouse

TASK [clickhouse-role : Set clickhouse_service_enable] **********************************************************************************************************************************************************************************
ok: [clickhouse]

TASK [clickhouse-role : Set clickhouse_service_ensure] **********************************************************************************************************************************************************************************
ok: [clickhouse]

TASK [clickhouse-role : include_tasks] **************************************************************************************************************************************************************************************************
included: /opt/ansible_hw4/playbook/roles/clickhouse-role/tasks/install/apt.yml for clickhouse

TASK [clickhouse-role : Install by APT | Apt-key add repo key] **************************************************************************************************************************************************************************
ok: [clickhouse]

TASK [clickhouse-role : Install by APT | Remove old repo] *******************************************************************************************************************************************************************************
ok: [clickhouse]

TASK [clickhouse-role : Install by APT | Repo installation] *****************************************************************************************************************************************************************************
ok: [clickhouse]

TASK [clickhouse-role : Install by APT | Package installation] **************************************************************************************************************************************************************************
skipping: [clickhouse]

TASK [clickhouse-role : Install by APT | Package installation] **************************************************************************************************************************************************************************
ok: [clickhouse]

TASK [clickhouse-role : Hold specified version during APT upgrade | Package installation] ***********************************************************************************************************************************************
ok: [clickhouse] => (item=clickhouse-client)
ok: [clickhouse] => (item=clickhouse-server)
ok: [clickhouse] => (item=clickhouse-common-static)

TASK [clickhouse-role : include_tasks] **************************************************************************************************************************************************************************************************
included: /opt/ansible_hw4/playbook/roles/clickhouse-role/tasks/configure/sys.yml for clickhouse

TASK [clickhouse-role : Check clickhouse config, data and logs] *************************************************************************************************************************************************************************
ok: [clickhouse] => (item=/var/log/clickhouse-server)
changed: [clickhouse] => (item=/etc/clickhouse-server)
changed: [clickhouse] => (item=/var/lib/clickhouse/tmp/)
changed: [clickhouse] => (item=/var/lib/clickhouse/)

TASK [clickhouse-role : Config | Create config.d folder] ********************************************************************************************************************************************************************************
changed: [clickhouse]

TASK [clickhouse-role : Config | Create users.d folder] *********************************************************************************************************************************************************************************
changed: [clickhouse]

TASK [clickhouse-role : Config | Generate system config] ********************************************************************************************************************************************************************************
changed: [clickhouse]

TASK [clickhouse-role : Config | Generate users config] *********************************************************************************************************************************************************************************
changed: [clickhouse]

TASK [clickhouse-role : Config | Generate remote_servers config] ************************************************************************************************************************************************************************
skipping: [clickhouse]

TASK [clickhouse-role : Config | Generate macros config] ********************************************************************************************************************************************************************************
skipping: [clickhouse]

TASK [clickhouse-role : Config | Generate zookeeper servers config] *********************************************************************************************************************************************************************
skipping: [clickhouse]

TASK [clickhouse-role : Config | Fix interserver_http_port and intersever_https_port collision] *****************************************************************************************************************************************
skipping: [clickhouse]

TASK [clickhouse-role : Notify Handlers Now] ********************************************************************************************************************************************************************************************

RUNNING HANDLER [clickhouse-role : Restart Clickhouse Service] **************************************************************************************************************************************************************************
ok: [clickhouse]

TASK [clickhouse-role : include_tasks] **************************************************************************************************************************************************************************************************
included: /opt/ansible_hw4/playbook/roles/clickhouse-role/tasks/service.yml for clickhouse

TASK [clickhouse-role : Ensure clickhouse-server.service is enabled: True and state: restarted] *****************************************************************************************************************************************
changed: [clickhouse]

TASK [clickhouse-role : Wait for Clickhouse Server to Become Ready] *********************************************************************************************************************************************************************
ok: [clickhouse]

TASK [clickhouse-role : include_tasks] **************************************************************************************************************************************************************************************************
included: /opt/ansible_hw4/playbook/roles/clickhouse-role/tasks/configure/db.yml for clickhouse

TASK [clickhouse-role : Set ClickHose Connection String] ********************************************************************************************************************************************************************************
ok: [clickhouse]

TASK [clickhouse-role : Gather list of existing databases] ******************************************************************************************************************************************************************************
ok: [clickhouse]

TASK [clickhouse-role : Config | Delete database config] ********************************************************************************************************************************************************************************
skipping: [clickhouse]

TASK [clickhouse-role : Config | Create database config] ********************************************************************************************************************************************************************************
skipping: [clickhouse]

TASK [clickhouse-role : include_tasks] **************************************************************************************************************************************************************************************************
included: /opt/ansible_hw4/playbook/roles/clickhouse-role/tasks/configure/dict.yml for clickhouse

TASK [clickhouse-role : Config | Generate dictionary config] ****************************************************************************************************************************************************************************
skipping: [clickhouse]

TASK [clickhouse-role : include_tasks] **************************************************************************************************************************************************************************************************
skipping: [clickhouse]

PLAY [Install Lighthouse] ***************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] ******************************************************************************************************************************************************************************************************************
[WARNING]: Platform linux on host lighthouse is using the discovered Python interpreter at /usr/bin/python3.12, but future installation of another Python interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-core/2.17/reference_appendices/interpreter_discovery.html for more information.
ok: [lighthouse]

TASK [lighthouse-role : Install nginx] **************************************************************************************************************************************************************************************************
ok: [lighthouse]

TASK [lighthouse-role : Create Nginx config] ********************************************************************************************************************************************************************************************
ok: [lighthouse]

TASK [lighthouse-role : Install git] ****************************************************************************************************************************************************************************************************
ok: [lighthouse]

TASK [lighthouse-role : Copy lighthouse rfom git] ***************************************************************************************************************************************************************************************
ok: [lighthouse]

TASK [lighthouse-role : Create lighthouse config] ***************************************************************************************************************************************************************************************
ok: [lighthouse]

PLAY [Install Vector] *******************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] ******************************************************************************************************************************************************************************************************************
[WARNING]: Platform linux on host vector is using the discovered Python interpreter at /usr/bin/python3.12, but future installation of another Python interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-core/2.17/reference_appendices/interpreter_discovery.html for more information.
ok: [vector]

TASK [vector-role : Create vector work directory] ***************************************************************************************************************************************************************************************
ok: [vector]

TASK [vector-role : Get Vector distrib] *************************************************************************************************************************************************************************************************
ok: [vector]

TASK [vector-role : Unzip Vector archive] ***********************************************************************************************************************************************************************************************
ok: [vector]

TASK [vector-role : Install Vector binary] **********************************************************************************************************************************************************************************************
ok: [vector]

TASK [vector-role : Check Vector installation] ******************************************************************************************************************************************************************************************
changed: [vector]

TASK [vector-role : Create Vector config vector.toml] ***********************************************************************************************************************************************************************************
ok: [vector]

TASK [vector-role : Create vector.service daemon] ***************************************************************************************************************************************************************************************
changed: [vector]

TASK [vector-role : Modify vector.service file] *****************************************************************************************************************************************************************************************
changed: [vector]

TASK [vector-role : Create user vector] *************************************************************************************************************************************************************************************************
ok: [vector]

TASK [vector-role : Create Vector data_dir] *********************************************************************************************************************************************************************************************
ok: [vector]

RUNNING HANDLER [vector-role : Start Vector service] ************************************************************************************************************************************************************************************
changed: [vector]

PLAY RECAP ******************************************************************************************************************************************************************************************************************************
clickhouse                 : ok=27   changed=6    unreachable=0    failed=0    skipped=10   rescued=0    ignored=0   
lighthouse                 : ok=6    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
vector                     : ok=12   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   